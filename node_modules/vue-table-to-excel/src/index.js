class JsonToExcel {
    getXlsx(jsonData, header, name = '数据报表.xlsx') {
        if (!Array.isArray(jsonData)) throw new Error(`${jsonData} is must be Array and not empty!`)
        if (!Array.isArray(header)) throw new Error(`${header} is must be Array and not empty!`)
        let str = header.toString() + '\n'
        for (let i = 0; i < jsonData.length; i++) {
            for (let item in jsonData[i]) {
                str += `${jsonData[i][item] + '\t'},`
            }
            str += '\n'
        }
        //encodeURIComponent解决中文乱码
        let uri = 'data:text/csv;charset=utf-8,\ufeff' + encodeURIComponent(str)
        //通过创建a标签实现
        var link = document.createElement("a")
        link.href = uri
        //对下载的文件命名
        link.download = name
        document.body.appendChild(link)
        link.click()
        document.body.removeChild(link)
    }
}
const initial = new JsonToExcel()
window.jsontoexcel = initial
export const jsontoexcel = initial